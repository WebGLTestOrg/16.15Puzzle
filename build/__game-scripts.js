var ScaleCameraOrthoSize=pc.createScript("scaleCameraOrthoSize");ScaleCameraOrthoSize.attributes.add("camera",{type:"entity"}),ScaleCameraOrthoSize.attributes.add("refResolution",{type:"vec2",default:[1960,1200],title:"Reference Resolution",description:"–ë–∞–∑–æ–≤–æ–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ —ç–∫—Ä–∞–Ω–∞"}),ScaleCameraOrthoSize.attributes.add("refOrthoSize",{type:"number",default:5,title:"Reference Ortho Size",description:"–û—Ä—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–π —Ä–∞–∑–º–µ—Ä –¥–ª—è –±–∞–∑–æ–≤–æ–≥–æ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è"}),ScaleCameraOrthoSize.prototype.initialize=function(){this.prevWidth=this.app.graphicsDevice.width,this.prevHeight=this.app.graphicsDevice.height,this.updateOrthoSize()},ScaleCameraOrthoSize.prototype.update=function(){var e=this.app.graphicsDevice.width,t=this.app.graphicsDevice.height;e===this.prevWidth&&t===this.prevHeight||(this.prevWidth=e,this.prevHeight=t,this.updateOrthoSize())},ScaleCameraOrthoSize.prototype.updateOrthoSize=function(){var e=this.refResolution.x/this.refResolution.y,t=this.app.graphicsDevice.width/this.app.graphicsDevice.height;this.camera.camera.orthoHeight=t>e?this.refOrthoSize:this.refOrthoSize*(e/t)};var Loader=pc.createScript("loader");Loader.attributes.add("btnMob",{type:"entity"}),Loader.attributes.add("btnDesk",{type:"entity"}),Loader.attributes.add("buildNumber",{type:"number"}),Loader.prototype.initialize=function(){this.loadScene("Game")},Loader.prototype.initializeStart=function(){this.isMobile()?this.btnMob.element.on("click",this.start,this):this.btnDesk.element.on("click",this.start,this)},Loader.prototype.start=function(){this.isMobile()?this.loadScene("GameScene_Mobile"):this.loadScene("GameScene_Desktop")},Loader.prototype.isMobile=function(){return!!pc.platform.mobile},Loader.prototype.loadScene=function(e){this.app.scenes.changeScene(e)};var SaveSystem=pc.createScript("saveSystem");SaveSystem.instance=null,SaveSystem.prototype.data={coins:0,level:1,items:[],logs:null},SaveSystem.prototype.storageKey="myGameSave",SaveSystem.getInstance=function(){if(!SaveSystem.instance){console.warn("SaveSystem instance not found. Creating new one.");var e=new pc.Entity("SaveSystem");e.addComponent("script"),e.script.create("saveSystem"),pc.app.root.addChild(e)}return SaveSystem.instance},SaveSystem.prototype.initialize=function(){if(SaveSystem.instance)return console.warn("SaveSystem already exists"),void this.entity.destroy();SaveSystem.instance=this,this.load(),this.entity.reparent(null),window.addEventListener("beforeunload",this.save.bind(this))},SaveSystem.prototype.update=function(e){this.saveTimer||(this.saveTimer=0),this.saveTimer+=e,this.saveTimer>=5&&(this.save(),this.saveTimer=0)},SaveSystem.prototype.save=function(){try{var e=JSON.stringify(this.data);localStorage.setItem(this.storageKey,e)}catch(e){console.error("Failed to save:",e)}},SaveSystem.prototype.load=function(){try{var e=localStorage.getItem(this.storageKey);e&&(this.data=JSON.parse(e),console.log("[SaveSystem] Loaded:",this.data))}catch(e){console.error("Failed to load:",e)}};var ScaleRectByScreenWidth=pc.createScript("scaleRectByScreenWidth");ScaleRectByScreenWidth.attributes.add("scaleFactor",{type:"number",default:1,title:"Scale Factor",description:"–ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è (–æ—Ç 0 –¥–æ 1)"}),ScaleRectByScreenWidth.attributes.add("refResolution",{type:"vec2",default:[1920,1080],title:"Reference Resolution",description:"–ë–∞–∑–æ–≤–æ–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ —ç–∫—Ä–∞–Ω–∞"}),ScaleRectByScreenWidth.attributes.add("targetRects",{type:"entity",array:!0,title:"Target Rects",description:"–°–ø–∏—Å–æ–∫ —Ü–µ–ª–µ–≤—ã—Ö –æ–±—ä–µ–∫—Ç–æ–≤ –¥–ª—è –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è"}),ScaleRectByScreenWidth.prototype.initialize=function(){this.initScales=[];for(var t=0;t<this.targetRects.length;t++){var e=this.targetRects[t];e&&(this.initScales[t]=e.getLocalScale().clone())}this.lastWidth=this.app.graphicsDevice.width,this.lastHeight=this.app.graphicsDevice.height,this.updateScale()},ScaleRectByScreenWidth.prototype.update=function(){var t=this.app.graphicsDevice.width,e=this.app.graphicsDevice.height;t===this.lastWidth&&e===this.lastHeight||(this.lastWidth=t,this.lastHeight=e,this.updateScale())},ScaleRectByScreenWidth.prototype.updateScale=function(){var t=this.app.graphicsDevice.width,e=this.app.graphicsDevice.height;if(0!==t&&0!==e){var i=this.refResolution.x/this.refResolution.y,a=t/e;if(a<i)for(var c=pc.math.lerp(1,a/i,this.scaleFactor),s=0;s<this.targetRects.length;s++){if(r=this.targetRects[s]){var h=this.initScales[s];r.setLocalScale(h.x*c,h.y*c,h.z)}}else for(s=0;s<this.targetRects.length;s++){var r;if(r=this.targetRects[s]){h=this.initScales[s];r.setLocalScale(h.x,h.y,h.z)}}}else this.app.once("postupdate",this.updateScale,this)};var Logger=pc.createScript("logger");Logger.instance=null,Logger.getInstance=function(){if(!Logger.instance){console.warn("Logger instance not found. Creating new one.");var e=new pc.Entity("Logger");e.addComponent("script"),e.script.create("logger"),pc.app.root.addChild(e)}return Logger.instance},Logger.prototype.initialize=function(){if(Logger.instance)return console.warn("Logger already exists"),void this.entity.destroy();Logger.instance=this,this.entity.reparent(null),this.logs=[],this.exitLog={type:"Exit",token:"b758b8ca-b9b0-40f6-9ff6-46d7a3d44d74",moves:0},this.gameCompletedLog={type:"GameCompleted",token:"b758b8ca-b9b0-40f6-9ff6-46d7a3d44d74",points:1500,moves:0,time:0,history:[]},this.gameLose={type:"GameLose",token:"b758b8ca-b9b0-40f6-9ff6-46d7a3d44d74",points:0,moves:0,history:[]},window.addEventListener("beforeunload",this.exitGame.bind(this))},Logger.prototype.logMove=function(e){this.logs.push(e)},Logger.prototype.exitGame=function(){this.exitLog.moves=this.logs.length,this.showLogs(this.exitLog)},Logger.prototype.completedGame=function(){this.gameCompletedLog.moves=this.logs.length,this.gameCompletedLog.history=this.logs.slice(),this.gameCompletedLog.time=Timer.instance.totalSeconds,this.showLogs(this.gameCompletedLog)},Logger.prototype.loseGame=function(){this.gameLose.moves=this.logs.length,this.gameLose.history=this.logs.slice(),this.showLogs(this.gameLose)},Logger.prototype.showLogs=function(e){console.log(JSON.parse(JSON.stringify(e)))};var Test=pc.createScript("test");Test.prototype.initialize=function(){console.log(SaveSystem.getInstance().data.coins)},Test.prototype.update=function(t){};var Tile=pc.createScript("tile");Tile.attributes.add("textElement",{type:"entity"}),Tile.attributes.add("imageEntity",{type:"entity",title:"Image for 8"}),Tile.prototype.initialize=function(){this.entity.element.on("click",this.onClick,this),this.enabledForInput=!0},Tile.prototype.onClick=function(){this.enabledForInput&&this.app.fire("tile:clicked",this)},Tile.prototype.setText=function(t){this.value=t,this.textElement&&this.textElement.element&&(this.textElement.element.text=t.toString(),this.textElement.enabled=8!==t),this.imageEntity&&(this.imageEntity.enabled=8===t)},Tile.prototype.clear=function(){this.enabledForInput=!1,this.textElement&&(this.textElement.enabled=!1),this.imageEntity&&(this.imageEntity.enabled=!1)};var Board=pc.createScript("board");Board.attributes.add("tiles",{type:"entity",array:!0}),Board.attributes.add("tileSize",{type:"number",default:100}),Board.attributes.add("testMode",{type:"boolean",default:!1,title:"–£–ø—Ä–æ—â—ë–Ω–Ω—ã–π —Å—Ç–∞—Ä—Ç (–±–µ–∑ –ø–æ—Å–ª–µ–¥–Ω–µ–π —Å—Ç—Ä–æ–∫–∏)"}),Board.instance=null,Board.prototype.initialize=function(){this.gridSize=4,Board.instance=this,this.tiles.push(null),this.positions=this.tiles.map((t=>t?t.getLocalPosition().clone():null)),this.positions[15]||(this.positions[15]=this.getGridPosition(3,3)),this.emptyIndex=15,this.shuffleTexts(),this.logger=Logger.getInstance(),this.gameCompleted=!1,this.app.on("tile:clicked",this.onTileClicked,this)},Board.prototype.getGridPosition=function(t,i){const e=this.tileSize*(this.gridSize-1)*.5,s=t*this.tileSize-e,o=-i*this.tileSize+e;return new pc.Vec3(s,o,0)},Board.prototype.shuffleTexts=function(){let t;if(this.testMode){const i=Array.from({length:12},((t,i)=>i+1)),e=[13,14,15];e.sort((()=>Math.random()-.5)),t=[...i,...e]}else t=Array.from({length:15},((t,i)=>i+1)),t.sort((()=>Math.random()-.5));for(let i=0;i<15;i++){const e=this.tiles[i];e?.script?.tile&&e.script.tile.setText(t[i])}},Board.prototype.onTileClicked=function(t){if(this.gameCompleted)return;const i=t.entity,e=this.tiles.indexOf(i),s=this.emptyIndex;if(-1===e||-1===s)return;const o=e%this.gridSize,n=Math.floor(e/this.gridSize),r=s%this.gridSize,l=Math.floor(s/this.gridSize);if(!(Math.abs(o-r)+Math.abs(n-l)===1))return;i.tween(i.getLocalPosition()).to(this.positions[s].clone(),.05,pc.SineOut).start();const a=`Tile ${i.script.tile?.value??"?"} ‚Üí empty`;this.logger.logMove(a),this.tiles[s]=i,this.tiles[e]=null,this.emptyIndex=e,this.checkWin()},Board.prototype.checkWin=function(){for(let t=0;t<15;t++){const i=this.tiles[t]?.script?.tile;if(!i||i.value!==t+1)return}console.log("üéâ –ü–æ–±–µ–¥–∞!"),Timer.instance.running=!1,this.logger.completedGame(),this.gameCompleted=!0,this.app.fire("game:win")};!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(require("playcanvas")):"function"==typeof define&&define.amd?define(["playcanvas"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).pc)}(this,(function(t){"use strict";const Linear=function(t){return t},BounceOut=function(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375},BounceIn=function(t){return 1-BounceOut(1-t)};var e=Object.freeze({__proto__:null,BackIn:function(t){const e=1.70158;return t*t*((e+1)*t-e)},BackInOut:function(t){const e=2.5949095;return(t*=2)<1?t*t*((e+1)*t-e)*.5:.5*((t-=2)*t*((e+1)*t+e)+2)},BackOut:function(t){const e=1.70158;return--t*t*((e+1)*t+e)+1},BounceIn:BounceIn,BounceInOut:function(t){return t<.5?.5*BounceIn(2*t):.5*BounceOut(2*t-1)+.5},BounceOut:BounceOut,CircularIn:function(t){return 1-Math.sqrt(1-t*t)},CircularInOut:function(t){return(t*=2)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1)},CircularOut:function(t){return Math.sqrt(1- --t*t)},CubicIn:function(t){return t*t*t},CubicInOut:function(t){return(t*=2)<1?.5*t*t*t:.5*((t-=2)*t*t+2)},CubicOut:function(t){return--t*t*t+1},ElasticIn:function(t){let e,i=.1;return 0===t?0:1===t?1:(!i||i<1?(i=1,e=.1):e=.4*Math.asin(1/i)/(2*Math.PI),-i*Math.pow(2,10*(t-=1))*Math.sin((t-e)*(2*Math.PI)/.4))},ElasticInOut:function(t){const e=.4;let i,s=.1;return 0===t?0:1===t?1:(!s||s<1?(s=1,i=.1):i=e*Math.asin(1/s)/(2*Math.PI),(t*=2)<1?s*Math.pow(2,10*(t-=1))*Math.sin((t-i)*(2*Math.PI)/e)*-.5:s*Math.pow(2,-10*(t-=1))*Math.sin((t-i)*(2*Math.PI)/e)*.5+1)},ElasticOut:function(t){let e,i=.1;return 0===t?0:1===t?1:(!i||i<1?(i=1,e=.1):e=.4*Math.asin(1/i)/(2*Math.PI),i*Math.pow(2,-10*t)*Math.sin((t-e)*(2*Math.PI)/.4)+1)},ExponentialIn:function(t){return 0===t?0:Math.pow(1024,t-1)},ExponentialInOut:function(t){return 0===t?0:1===t?1:(t*=2)<1?.5*Math.pow(1024,t-1):.5*(2-Math.pow(2,-10*(t-1)))},ExponentialOut:function(t){return 1===t?1:1-Math.pow(2,-10*t)},Linear:Linear,QuadraticIn:function(t){return t*t},QuadraticInOut:function(t){return(t*=2)<1?.5*t*t:-.5*(--t*(t-2)-1)},QuadraticOut:function(t){return t*(2-t)},QuarticIn:function(t){return t*t*t*t},QuarticInOut:function(t){return(t*=2)<1?.5*t*t*t*t:-.5*((t-=2)*t*t*t-2)},QuarticOut:function(t){return 1- --t*t*t*t},QuinticIn:function(t){return t*t*t*t*t},QuinticInOut:function(t){return(t*=2)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2)},QuinticOut:function(t){return--t*t*t*t*t+1},SineIn:function(t){return 0===t?0:1===t?1:1-Math.cos(t*Math.PI/2)},SineInOut:function(t){return 0===t?0:1===t?1:.5*(1-Math.cos(Math.PI*t))},SineOut:function(t){return 0===t?0:1===t?1:Math.sin(t*Math.PI/2)}});class TweenManager{_tweens=[];_add=[];add(t){return this._add.push(t),t}update(t){let e=0,i=this._tweens.length;for(;e<i;)this._tweens[e].update(t)?e++:(this._tweens.splice(e,1),i--);if(this._add.length){for(let t=0;t<this._add.length;t++)this._tweens.indexOf(this._add[t])>-1||this._tweens.push(this._add[t]);this._add.length=0}}}class Tween extends t.EventHandler{constructor(e,i,s){super(),this.manager=i,s&&(this.entity=null),this.time=0,this.complete=!1,this.playing=!1,this.stopped=!0,this.pending=!1,this.target=e,this.duration=0,this._currentDelay=0,this.timeScale=1,this._reverse=!1,this._delay=0,this._yoyo=!1,this._count=0,this._numRepeats=0,this._repeatDelay=0,this._from=!1,this._slerp=!1,this._fromQuat=new t.Quat,this._toQuat=new t.Quat,this._quat=new t.Quat,this.easing=Linear,this._sv={},this._ev={}}_parseProperties(e){let i;return e instanceof t.Vec2?i={x:e.x,y:e.y}:e instanceof t.Vec3?i={x:e.x,y:e.y,z:e.z}:e instanceof t.Vec4||e instanceof t.Quat?i={x:e.x,y:e.y,z:e.z,w:e.w}:e instanceof t.Color?(i={r:e.r,g:e.g,b:e.b},void 0!==e.a&&(i.a=e.a)):i=e,i}to(t,e,i,s,n,r){return this._properties=this._parseProperties(t),this.duration=e,i&&(this.easing=i),s&&this.delay(s),n&&this.repeat(n),r&&this.yoyo(r),this}from(t,e,i,s,n,r){return this._properties=this._parseProperties(t),this.duration=e,i&&(this.easing=i),s&&this.delay(s),n&&this.repeat(n),r&&this.yoyo(r),this._from=!0,this}rotate(t,e,i,s,n,r){return this._properties=this._parseProperties(t),this.duration=e,i&&(this.easing=i),s&&this.delay(s),n&&this.repeat(n),r&&this.yoyo(r),this._slerp=!0,this}start(){let t,e,i,s;if(this.playing=!0,this.complete=!1,this.stopped=!1,this._count=0,this.pending=this._delay>0,this._reverse&&!this.pending?this.time=this.duration:this.time=0,this._from){for(t in this._properties)this._properties.hasOwnProperty(t)&&(this._sv[t]=this._properties[t],this._ev[t]=this.target[t]);this._slerp&&(this._toQuat.setFromEulerAngles(this.target.x,this.target.y,this.target.z),e=void 0!==this._properties.x?this._properties.x:this.target.x,i=void 0!==this._properties.y?this._properties.y:this.target.y,s=void 0!==this._properties.z?this._properties.z:this.target.z,this._fromQuat.setFromEulerAngles(e,i,s))}else{for(t in this._properties)this._properties.hasOwnProperty(t)&&(this._sv[t]=this.target[t],this._ev[t]=this._properties[t]);this._slerp&&(e=void 0!==this._properties.x?this._properties.x:this.target.x,i=void 0!==this._properties.y?this._properties.y:this.target.y,s=void 0!==this._properties.z?this._properties.z:this.target.z,void 0!==this._properties.w?(this._fromQuat.copy(this.target),this._toQuat.set(e,i,s,this._properties.w)):(this._fromQuat.setFromEulerAngles(this.target.x,this.target.y,this.target.z),this._toQuat.setFromEulerAngles(e,i,s)))}return this._currentDelay=this._delay,this.manager.add(this),this}pause(){this.playing=!1}resume(){this.playing=!0}stop(){this.playing=!1,this.stopped=!0}delay(t){return this._delay=t,this.pending=!0,this}repeat(t,e){return this._count=0,this._numRepeats=t,this._repeatDelay=e||0,this}loop(t){return t?(this._count=0,this._numRepeats=1/0):this._numRepeats=0,this}yoyo(t){return this._yoyo=t,this}reverse(){return this._reverse=!this._reverse,this}chain(){let t=arguments.length;for(;t--;)t>0?arguments[t-1]._chained=arguments[t]:this._chained=arguments[t];return this}onUpdate(t){return this.on("update",t),this}onComplete(t){return this.on("complete",t),this}onLoop(t){return this.on("loop",t),this}update(t){if(this.stopped)return!1;if(!this.playing)return!0;if(!this._reverse||this.pending?this.time+=t*this.timeScale:this.time-=t*this.timeScale,this.pending){if(!(this.time>this._currentDelay))return!0;this._reverse?this.time=this.duration-(this.time-this._currentDelay):this.time-=this._currentDelay,this.pending=!1}let e=0;(!this._reverse&&this.time>this.duration||this._reverse&&this.time<0)&&(this._count++,this.complete=!0,this.playing=!1,this._reverse?(e=this.duration-this.time,this.time=0):(e=this.time-this.duration,this.time=this.duration));const i=0===this.duration?1:this.time/this.duration,s=this.easing(i);let n,r;for(const t in this._properties)this._properties.hasOwnProperty(t)&&(n=this._sv[t],r=this._ev[t],this.target[t]=n+(r-n)*s);if(this._slerp&&this._quat.slerp(this._fromQuat,this._toQuat,s),this.entity&&(this.entity._dirtifyLocal(),this.element&&this.entity.element&&(this.entity.element[this.element]=this.target),this._slerp&&this.entity.setLocalRotation(this._quat)),this.fire("update",t),this.complete){const t=this._repeat(e);return t?this.fire("loop"):(this.fire("complete",e),this.entity&&this.entity.off("destroy",this.stop,this),this._chained&&this._chained.start()),t}return!0}_repeat(t){if(this._count<this._numRepeats){if(this._reverse?this.time=this.duration-t:this.time=t,this.complete=!1,this.playing=!0,this._currentDelay=this._repeatDelay,this.pending=!0,this._yoyo){for(const t in this._properties){const e=this._sv[t];this._sv[t]=this._ev[t],this._ev[t]=e}this._slerp&&(this._quat.copy(this._fromQuat),this._fromQuat.copy(this._toQuat),this._toQuat.copy(this._quat))}return!0}return!1}}const i=new Map,getTweenManager=e=>{if(!(e&&e instanceof t.AppBase))throw new Error("`getTweenManager` expects an instance of `AppBase`");if(!i.has(e)){const t=new TweenManager;i.set(e,t),e.on("update",(e=>{t.update(e)})),e.on("destroy",(()=>i.delete(e)))}return i.get(e)};if(!globalThis.pc)throw new Error("There is no global `pc` playcanvas object.");Object.assign(globalThis.pc,e),(({AppBase:t,Entity:e})=>{if(!t)throw new Error("The param `addExtensions` must contain the `AppBase` class. `addExtensions({ AppBase })`");if(!e)throw new Error("The param `addExtensions` must contain the `Entity` class. `addExtensions({ Entity })`");t.prototype.tween=function(t){const e=getTweenManager(this);return new Tween(t,e)},e.prototype.tween=function(t,e){return((t,e,i)=>{const s=getTweenManager(t._app),n=new Tween(e,s);return n.entity=t,t.once("destroy",n.stop,n),i&&i.element&&(n.element=i.element),n})(this,t,e)}})(globalThis.pc),globalThis.pc.AppBase.prototype.addTweenManager=function(){this._tweenManager=getTweenManager(this)}}));var Timer=pc.createScript("timer");Timer.attributes.add("label",{type:"entity",title:"Text Element"}),Timer.attributes.add("startSeconds",{type:"number",default:60,title:"–û–±—â–µ–µ –≤—Ä–µ–º—è (—Å–µ–∫—É–Ω–¥)"}),Timer.instance=null,Timer.prototype.initialize=function(){Timer.instance=this,this.totalSeconds=this.startSeconds,this.running=!0,this.timeAccumulator=0,this.updateLabel(),this.app.on("game:reset",this.reset,this)},Timer.prototype.update=function(t){!this.running||this.totalSeconds<=0||(this.timeAccumulator+=t,this.timeAccumulator>=1&&(this.timeAccumulator=0,this.totalSeconds--,this.updateLabel(),this.totalSeconds<=0&&this.stop()))},Timer.prototype.updateLabel=function(){const t=Math.floor(this.totalSeconds/60),e=this.totalSeconds%60,i=`${this.pad(t)}:${this.pad(e)}`;this.label?.element&&(this.label.element.text=i)},Timer.prototype.pad=function(t){return t<10?"0"+t:t},Timer.prototype.stop=function(){this.running=!1,Board.instance.gameCompleted=!0,Logger.instance.loseGame()},Timer.prototype.reset=function(){this.totalSeconds=this.startSeconds,this.timeAccumulator=0,this.running=!0,this.updateLabel()};pc.script.createLoadingScreen((function(n){n.on("preload:progress",(function(){})),n.on("preload:end",(function(){})),n.on("start",(function(){}))}));